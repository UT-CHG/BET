

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example: Concentration of Contaminant in Wells Based on Transport Parameters &mdash; BET 1.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="BET 1.0.0 documentation" href="../../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> BET</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#package-layout">Package Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#code-overview">Code Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#internal-dependencies">Internal dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#external-dependencies">External dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../parallel.html">Parallel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#running-in-parallel">Running in parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#parallel-enabled-modules">Parallel Enabled Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Some References and Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#validation-example">Validation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#linear-map-example">Linear Map Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#non-linear-map-example">Non-Linear Map Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#adcirc-based-examples">ADCIRC Based Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#contaminant-transport-example">Contaminant Transport Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#choosing-optimal-qois-example">Choosing Optimal QoIs Example:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">bet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../bet.html">bet package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../todo_list.html">Todo List</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">BET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Example: Concentration of Contaminant in Wells Based on Transport Parameters</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/examples/example_rst_files/contaminantTransport.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="example-concentration-of-contaminant-in-wells-based-on-transport-parameters">
<span id="contaminanttransport"></span><h1>Example: Concentration of Contaminant in Wells Based on Transport Parameters<a class="headerlink" href="#example-concentration-of-contaminant-in-wells-based-on-transport-parameters" title="Permalink to this headline">¶</a></h1>
<p>We will walk through the following <a class="reference external" href="https://github.com/UT-CHG/BET/tree/master/examples/contaminantTransport">example</a>.
This example takes uniformly distributed samples of parameters and
output data from a simple groundwater contaminant transport model,
and calculates solutions to the stochastic inverse problem.
The parameter domain is 5D, where the uncertain parameters are the x and y
locations of the source, the horizontal dispersivity, the flow angle,
and the contaminant flux. There are 11 measured QoIs in the data space
available. By changing the choice of QoIs that we use to solve the stochastic
inverse problem, we see the effect of geometric distinctness.
Probabilities in the parameter space are
calculated using the MC assumption.  1D and 2D marginals are calculated,
smoothed, and plotted. The samples are then ranked by probability density
and the volume of high-probability regions are calculated. Probabilistic predictions of other QoI are made.</p>
<p>Import the necessary modules:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">bet.calculateP</span> <span class="kn">as</span> <span class="nn">calculateP</span>
<span class="kn">import</span> <span class="nn">bet.postProcess</span> <span class="kn">as</span> <span class="nn">postProcess</span>
<span class="kn">import</span> <span class="nn">bet.calculateP.simpleFunP</span> <span class="kn">as</span> <span class="nn">simpleFunP</span>
<span class="kn">import</span> <span class="nn">bet.calculateP.calculateP</span> <span class="kn">as</span> <span class="nn">calculateP</span>
<span class="kn">import</span> <span class="nn">bet.postProcess.plotP</span> <span class="kn">as</span> <span class="nn">plotP</span>
<span class="kn">import</span> <span class="nn">bet.postProcess.plotDomains</span> <span class="kn">as</span> <span class="nn">plotD</span>
</pre></div>
</div>
<p>Import the samples, data, reference data, and reference parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lam_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&quot;files/lam_domain.txt.gz&quot;</span><span class="p">)</span> <span class="c">#parameter domain</span>
<span class="n">ref_lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&quot;files/lam_ref.txt.gz&quot;</span><span class="p">)</span> <span class="c">#reference parameter set</span>
<span class="n">Q_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&quot;files/Q_ref.txt.gz&quot;</span><span class="p">)</span> <span class="c">#reference QoI set</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&quot;files/samples.txt.gz&quot;</span><span class="p">)</span> <span class="c"># uniform samples in parameter domain</span>
<span class="n">dataf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&quot;files/data.txt.gz&quot;</span><span class="p">)</span> <span class="c"># data from model</span>
</pre></div>
</div>
<p>Choose which subset of the 11 QoIs to use for inversion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">QoI_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="c"># Indices for output data with which you want to invert</span>
</pre></div>
</div>
<p>Choose the bin ratio for the uniform output probability:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bin_ratio</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="c">#ratio of length of data region to invert</span>
</pre></div>
</div>
<p>Slice data and form approximate PDF for output for plotting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">dataf</span><span class="p">[:,</span><span class="n">QoI_indices</span><span class="p">]</span>
<span class="n">Q_ref</span><span class="o">=</span><span class="n">Q_ref</span><span class="p">[</span><span class="n">QoI_indices</span><span class="p">]</span>

<span class="n">dmax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dmin</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dscale</span> <span class="o">=</span> <span class="n">bin_ratio</span><span class="o">*</span><span class="p">(</span><span class="n">dmax</span><span class="o">-</span><span class="n">dmin</span><span class="p">)</span>
<span class="n">Qmax</span> <span class="o">=</span> <span class="n">Q_ref</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dscale</span>
<span class="n">Qmin</span> <span class="o">=</span> <span class="n">Q_ref</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dscale</span>
<span class="k">def</span> <span class="nf">rho_D</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Qmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Qmax</span><span class="p">)),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot 2D projections of the data domain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plotD</span><span class="o">.</span><span class="n">show_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Q_ref</span> <span class="o">=</span> <span class="n">Q_ref</span><span class="p">,</span> <span class="n">rho_D</span><span class="o">=</span><span class="n">rho_D</span><span class="p">,</span> <span class="n">showdim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="suggested-changes-for-user-1">
<h2>Suggested changes for user (1)<a class="headerlink" href="#suggested-changes-for-user-1" title="Permalink to this headline">¶</a></h2>
<p>Change the <code class="docutils literal"><span class="pre">QoI_indices</span></code> and note how it changes the plots of the data
domain. The white points are ones with zero probability and the dark points
are those with nonzero probability.</p>
</div>
<div class="section" id="suggested-changes-for-user-2">
<h2>Suggested changes for user (2)<a class="headerlink" href="#suggested-changes-for-user-2" title="Permalink to this headline">¶</a></h2>
<p>Try different ways of discretizing the probability measure on
<span class="math">\(\mathcal{D}\)</span> defined as a uniform probability measure on a rectangle
(since <span class="math">\(\mathcal{D}\)</span> is 2-dimensional).</p>
<ul class="simple">
<li>unif_unif creates a uniform measure on a hyperbox with dimensions relative   to the size of the circumscribed hyperbox of the set <span class="math">\(\mathcal{D}\)</span>  using the bin_ratio. A total of M samples are drawn within a slightly larger  scaled hyperbox to discretize this measure defining M total generalized  contour events in Lambda.  The reason a slightly larger scaled hyperbox is  used to draw the samples to discretize <span class="math">\(\mathcal{D}\)</span> is because  otherwise every generalized contour event will have non-zero probability  which obviously defeats the purpose of &#8220;localizing&#8221; the probability within a  subset of <span class="math">\(\mathcal{D}\)</span>.</li>
<li>uniform_hyperrectangle uses the same measure defined in the same way as  unif_unif, but the difference is in the discretization which is on a regular  grid defined by <code class="docutils literal"><span class="pre">center_pts_per_edge</span></code>.  If <code class="docutils literal"><span class="pre">center_pts_per_edge</span> <span class="pre">=</span> <span class="pre">1</span></code>,  then the contour event corresponding to the entire support of  <span class="math">\(\rho_\mathcal{D}\)</span> is approximated as a single event. This is done by  carefully placing a regular 3x3 grid (since <span class="math">\(dim(\mathcal{D})=2\)</span> in this  case) of points in <span class="math">\(\mathcal{D}\)</span> with the center point of the grid in  the center of the support of the measure and the other points placed outside  of the rectangle defining the support to define a total of 9 contour events  with 8 of them having exactly zero probability.</li>
</ul>
<p>Create a simple function approximation of the probablity measure on
<span class="math">\(\mathcal{D}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">deterministic_discretize_D</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">if</span> <span class="n">deterministic_discretize_D</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
  <span class="p">(</span><span class="n">d_distr_prob</span><span class="p">,</span> <span class="n">d_distr_samples</span><span class="p">,</span> <span class="n">d_Tree</span><span class="p">)</span> <span class="o">=</span> <span class="n">simpleFunP</span><span class="o">.</span><span class="n">uniform_hyperrectangle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                              <span class="n">Q_ref</span><span class="o">=</span><span class="n">Q_ref</span><span class="p">,</span> <span class="n">bin_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">center_pts_per_edge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="p">(</span><span class="n">d_distr_prob</span><span class="p">,</span> <span class="n">d_distr_samples</span><span class="p">,</span> <span class="n">d_Tree</span><span class="p">)</span> <span class="o">=</span> <span class="n">simpleFunP</span><span class="o">.</span><span class="n">unif_unif</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                              <span class="n">Q_ref</span><span class="o">=</span><span class="n">Q_ref</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">bin_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_d_emulate</span><span class="o">=</span><span class="mf">1E5</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate probablities using the MC assumption:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">P</span><span class="p">,</span>  <span class="n">lam_vol</span><span class="p">,</span> <span class="n">io_ptr</span><span class="p">)</span> <span class="o">=</span> <span class="n">calculateP</span><span class="o">.</span><span class="n">prob</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span>
                                      <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                      <span class="n">rho_D_M</span><span class="o">=</span><span class="n">d_distr_prob</span><span class="p">,</span>
                                      <span class="n">d_distr_samples</span><span class="o">=</span><span class="n">d_distr_samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-2d-marginal-probs-suggested-changes-for-user-3">
<h2>Calculate 2D marginal probs  - Suggested changes for user (3)<a class="headerlink" href="#calculate-2d-marginal-probs-suggested-changes-for-user-3" title="Permalink to this headline">¶</a></h2>
<p>At this point, the only thing that should change in the plotP.* inputs
should be either the nbins values or sigma (which influences the kernel
density estimation with smaller values implying a density estimate that
looks more like a histogram and larger values smoothing out the values
more).</p>
<p>There are ways to determine &#8220;optimal&#8221; smoothing parameters (e.g., see CV, GCV,
and other similar methods), but we have not incorporated these into the code
as lower-dimensional marginal plots have limited value in understanding the
structure of a high dimensional non-parametric probability measure.</p>
<p>Plot the marginal probabilities:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">marginals2D</span><span class="p">)</span> <span class="o">=</span> <span class="n">plotP</span><span class="o">.</span><span class="n">calculate_2D_marginal_probs</span><span class="p">(</span><span class="n">P_samples</span> <span class="o">=</span> <span class="n">P</span><span class="p">,</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">,</span> <span class="n">lam_domain</span> <span class="o">=</span> <span class="n">lam_domain</span><span class="p">,</span> <span class="n">nbins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>Smooth 2d marginals probs (optional):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">marginals2D</span> <span class="o">=</span> <span class="n">plotP</span><span class="o">.</span><span class="n">smooth_marginals_2D</span><span class="p">(</span><span class="n">marginals2D</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot 2d marginals probs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plotP</span><span class="o">.</span><span class="n">plot_2D_marginal_probs</span><span class="p">(</span><span class="n">marginals2D</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">lam_domain</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;contaminant_map&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lam_ref</span><span class="o">=</span><span class="n">ref_lam</span><span class="p">,</span> <span class="n">lambda_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate 1d marginal probs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">marginals1D</span><span class="p">)</span> <span class="o">=</span> <span class="n">plotP</span><span class="o">.</span><span class="n">calculate_1D_marginal_probs</span><span class="p">(</span><span class="n">P_samples</span> <span class="o">=</span> <span class="n">P</span><span class="p">,</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">,</span> <span class="n">lam_domain</span> <span class="o">=</span> <span class="n">lam_domain</span><span class="p">,</span> <span class="n">nbins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>Smooth 1d marginal probs (optional):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">marginals1D</span> <span class="o">=</span> <span class="n">plotP</span><span class="o">.</span><span class="n">smooth_marginals_1D</span><span class="p">(</span><span class="n">marginals1D</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot 1d marginal probs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plotP</span><span class="o">.</span><span class="n">plot_1D_marginal_probs</span><span class="p">(</span><span class="n">marginals1D</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">lam_domain</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;contaminant_map&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lam_ref</span><span class="o">=</span><span class="n">ref_lam</span><span class="p">,</span> <span class="n">lambda_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
<p>Sort samples by highest probability density and take highest x percent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">P_high</span><span class="p">,</span> <span class="n">samples_high</span><span class="p">,</span> <span class="n">lam_vol_high</span><span class="p">,</span> <span class="n">data_high</span><span class="p">)</span><span class="o">=</span> <span class="n">postTools</span><span class="o">.</span><span class="n">sample_highest_prob</span><span class="p">(</span><span class="n">top_percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">,</span> <span class="n">P_samples</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">lam_vol</span><span class="o">=</span><span class="n">lam_vol</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Print the number of these samples  and the ratio of the volume they take up:</p>
<div class="highlight-python"><div class="highlight"><pre>print (numsamples, np.sum(lam_vol_high)
</pre></div>
</div>
</div>
<div class="section" id="suggested-changes-for-user-4">
<h2>Suggested changes for user (4):<a class="headerlink" href="#suggested-changes-for-user-4" title="Permalink to this headline">¶</a></h2>
<p>Notice how the marginal probabilites change with different choices of  <code class="docutils literal"><span class="pre">QoI_indices</span></code>.
Try choosing only 2 or 3, instead of 4, indices and notice the higher-dimensionality of the structure in the 2d marginals. Notice how some QoI concentrate the probability into smaller regions. These QoI are more geometrically distinct.</p>
<p>Notice that the volume that the high-probability samples take up is smaller with more geometrically distinct QoIs.</p>
</div>
<div class="section" id="suggested-changes-for-user-5">
<h2>Suggested changes for user (5):<a class="headerlink" href="#suggested-changes-for-user-5" title="Permalink to this headline">¶</a></h2>
<p>Change <code class="docutils literal"><span class="pre">percentile</span></code> to values between 1.0 and 0.0. Notice that while the region of nonzero probabibilty may have a significant volume, much of this volume contains relatively low probability. Change the value to 0.95, 0.9, 0.75, and 0.5 and notice the volume decrease significantly.</p>
<p>Propogate highest probability part of the probability measure through a different QoI map:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">P_pred</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="p">,</span> <span class="n">data_pred</span><span class="p">)</span><span class="o">=</span> <span class="n">postTools</span><span class="o">.</span><span class="n">sample_highest_prob</span><span class="p">(</span><span class="n">top_percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">,</span> <span class="n">P_samples</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">lam_vol</span><span class="o">=</span><span class="n">lam_vol</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataf</span><span class="p">[:,</span><span class="mi">7</span><span class="p">],</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate and plot PDF of predicted QoI:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">bins_pred</span><span class="p">,</span> <span class="n">marginals1D_pred</span><span class="p">)</span> <span class="o">=</span> <span class="n">plotP</span><span class="o">.</span><span class="n">calculate_1D_marginal_probs</span><span class="p">(</span><span class="n">P_samples</span> <span class="o">=</span> <span class="n">P_pred</span><span class="p">,</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">data_pred</span><span class="p">,</span> <span class="n">lam_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_pred</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_pred</span><span class="p">)]]),</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">plotP</span><span class="o">.</span><span class="n">plot_1D_marginal_probs</span><span class="p">(</span><span class="n">marginals1D_pred</span><span class="p">,</span> <span class="n">bins_pred</span><span class="p">,</span> <span class="n">lam_domain</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_pred</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_pred</span><span class="p">)]]),</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;contaminant_prediction&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="suggested-changes-for-user-6">
<h2>Suggested changes for user (6):<a class="headerlink" href="#suggested-changes-for-user-6" title="Permalink to this headline">¶</a></h2>
<p>Change the prediction QoI map. Compare to the reference values.</p>
</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, The BET Development Team (Lindley Graham, Steven Mattis, Troy Butler).
      Last updated on Jul 14, 2015.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>